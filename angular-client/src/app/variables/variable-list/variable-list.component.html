<div class="items-list" *ngIf="variables.length > 0">
  <div class="items-header">
    <h2 >List of Variables</h2>
    <p data-placement="top" data-toggle="tooltip" title="Create">
      <button class="btn btn-primary"
              data-title="Create"
              data-toggle="modal"
              (click)="toggleCreateMode(variableForm)"
              data-target="#createNew">
        Create new variable
      </button>
    </p>
  </div>

  <table id="mytable" class="table table-bordred table-striped">
    <thead>
      <th>Variable</th>
      <th>View</th>
      <th>Edit</th>
      <th>Delete</th>
    </thead>
    <tbody>
      <tr *ngFor="let variable of variables">
        <td>{{variable.name}}</td>
        <td><a [routerLink]="['/variable', variable._id]" title="Click to Open {{variable.name}}">View</a></td>
        <td>
          <p data-placement="top" data-toggle="tooltip" title="Edit">
            <button class="btn btn-primary btn-xs" (click)="toggleEditMode(variable)" data-title="Edit" data-toggle="modal" data-target="#createNew"><span class="glyphicon glyphicon-pencil"></span></button>
          </p>
        </td>
        <td>
          <p data-placement="top" data-toggle="tooltip" title="Delete">
            <button class="btn btn-danger btn-xs" (click)="showDeleteVariable(variable)" data-title="Delete" data-toggle="modal" data-target="#delete"><span class="glyphicon glyphicon-trash"></span></button>
          </p>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Create/Edit Modal -->
  <div class="modal fade" id="createNew" role="dialog">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">{{(editMode) ? "Edit Variable" : "Create Variable"}}</h4>
        </div>
        <div class="modal-body">
          <div class="addVariableBox">
            <form (ngSubmit)="addVariable(variable, variableForm)" #variableForm="ngForm">
              <div class="form-group">
                <label>Name:</label>
                <input type="text"
                       [(ngModel)]="variable.name"
                       #variabletext="ngModel"
                       class="form-control"
                       name="variableText"
                       required/>
                <div [hidden]="variabletext.valid || variabletext.pristine" class="alert alert-danger">
                  Variable is required
                </div>
              </div>
              <label>Type:</label>
              <div class="form-check">
                <input class="form-check-input"
                       type="radio"
                       name="exampleRadios"
                       (ngModelChange)="resetValues('NUMERIC')"
                       id="exampleRadios1" value="NUMERIC" [(ngModel)]="variable.type">
                <label class="form-check-label" for="exampleRadios1">
                  NUMERIC
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input"
                       type="radio"
                       name="exampleRadios"
                       (ngModelChange)="resetValues('MULTIVALUE')"
                       id="exampleRadios2"
                       value="MULTIVALUE"
                       [(ngModel)]="variable.type">
                <label class="form-check-label" for="exampleRadios2">
                  MULTIVALUE
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input"
                       type="radio"
                       name="exampleRadios"
                       id="exampleRadios3"
                       value="UNIVALUE"
                       [(ngModel)]="variable.type"
                       (ngModelChange)="resetValues('UNIVALUE')">
                <label class="form-check-label" for="exampleRadios3">
                  UNIVALUE
                </label>
              </div>
              <div class="form-group">
                <label>Value:</label>
                <div class="input-group" *ngFor="let item of valuesList; let i = index" [attr.data-index]="i">
                  <input class="form-control" type="text" name="var-value-{{i}}" [(ngModel)]="item.value" required/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="button" (click)="removeValue(i)">Remove</button>
                  </span>
                </div>
                <div *ngIf="variable.type === 'MULTIVALUE'">
                  <button type="button" class="btn btn-default add-more" (click)="addMoreValues()">Add +</button>
                </div>
              </div>
              <button type="submit" [disabled]="!variableForm.form.valid" class="btn btn-success btn-block">Submit</button>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Modal -->
  <div class="modal fade" id="delete" role="dialog">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Delete Variable</h4>
        </div>
        <div class="modal-body">
          <div align="center" class="DeleteVariableBox">
            <div *ngIf="!apiMessage" align="center" class="alert alert-danger" role="alert">
              <p>Are you sure want to delete this variable?</p>
              <strong>{{variableToDelete.variableText}}</strong>
            </div>
            <div style="margin:10px;" *ngIf="apiMessage" align="center" class="alert alert-success" role="alert">
              <strong>{{variableToDelete.variableText}}</strong> {{apiMessage}}
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" *ngIf="!apiMessage" (click)="deleteVariable(variableToDelete)">Confirm</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="variables.length <= 0" class="NoVariablesBox">
  <div align="center" class="alert alert-info" role="alert">
    <strong>No Variables Available in Database</strong>
  </div>
</div>
